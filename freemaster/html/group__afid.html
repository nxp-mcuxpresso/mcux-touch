<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>NXP Touch Library Reference Manual: Advanced Filtering and Integrating Detection</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nxp_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">NXP Touch Library Reference Manual
   &#160;<span id="projectnumber">Rev 2.0</span>
   </div>
   <div id="projectbrief">NXP Semiconductors, Inc.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__afid.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Advanced Filtering and Integrating Detection<div class="ingroups"><a class="el" href="group__detectors.html">Key Detectors</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<p>The AFID (Advanced Filtering and Integrating Detection) key detector is based on using two IIR filters with different depths (one short / fast, the other long / slow) and on integrating the difference between the two filtered signals. The algorithm uses two thresholds: the touch threshold and the release threshold. The touch threshold is defined in the sensitivity register. The release threshold has a twice lower level than the touch threshold. If the integrated signal is higher than the touch threshold, or lower than the release threshold, then the integrated signal is reset. The touch state is reported for the electrode when the first touch reset is detected. The release state is reported when as many release resets are detected as the touch resets were detected during the previous touch state. </p>
<div class="dynheader">
Collaboration diagram for Advanced Filtering and Integrating Detection:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__afid.png" border="0" alt="" usemap="#group____afid"/>
<map name="group____afid" id="group____afid">
<area shape="rect" id="node2" href="group__detectors.html" title="Key Detectors" alt="" coords="5,13,111,39"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structnt__keydetector__afid__asc"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__afid.html#structnt__keydetector__afid__asc">nt_keydetector_afid_asc</a></td></tr>
<tr class="separator:structnt__keydetector__afid__asc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structnt__keydetector__afid"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__afid.html#structnt__keydetector__afid">nt_keydetector_afid</a></td></tr>
<tr class="separator:structnt__keydetector__afid"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga9f4ab088e1b54439d63a36b3503055f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__afid.html#ga9f4ab088e1b54439d63a36b3503055f3">NT_KEYDETECTOR_AFID_ASC_DEFAULT</a></td></tr>
<tr class="separator:ga9f4ab088e1b54439d63a36b3503055f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gab0fa0f9c83af71347537b8e35fa9867e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structnt__keydetector__interface.html">nt_keydetector_interface</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__afid.html#gab0fa0f9c83af71347537b8e35fa9867e">nt_keydetector_afid_interface</a></td></tr>
<tr class="separator:gab0fa0f9c83af71347537b8e35fa9867e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structnt__keydetector__afid__asc" id="structnt__keydetector__afid__asc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct nt_keydetector_afid_asc</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>AFID Automatic Sensitive Calibration structure; This structure is used to define the parameters of evaluating the AFID process flow. You can manage your own setup of parameters, or use the default setting in the <a class="el" href="group__afid.html#ga9f4ab088e1b54439d63a36b3503055f3">NT_KEYDETECTOR_AFID_ASC_DEFAULT</a>. This structure must be filled in. </p>
</div><div class="dynheader">
Collaboration diagram for nt_keydetector_afid_asc:</div>
<div class="dyncontent">
<div class="center"><img src="structnt__keydetector__afid__asc__coll__graph.png" border="0" usemap="#nt__keydetector__afid__asc_coll__map" alt="Collaboration graph"/></div>
<map name="nt__keydetector__afid__asc_coll__map" id="nt__keydetector__afid__asc_coll__map">
</map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a1d351c03cc981b2e5cf62d8a107706b1"></a>uint32_t</td>
<td class="fieldname">
noise_resets_minimum</td>
<td class="fielddoc">
<p>Noise Resets Minimum. If touch threshold is lower then noise reset minimum (low sensitivity) the touch threshold will be limited to noise level minimum value. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="acfa5637789987a47d254befdba78a484"></a>int16_t</td>
<td class="fieldname">
resets_for_touch</td>
<td class="fielddoc">
<p>Number of resets required for touch. The low number causes quicker touch event recognition, high number causes longer integration process. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a3516539a006194ded87aea22c8c1a11b"></a>int16_t</td>
<td class="fieldname">
touch_threshold_fall_rate</td>
<td class="fielddoc">
<p>Rate of how often the touch threshold can fall. The value represent the time period after each the touch threshold will fall down if touch threshold is higher then destination threshold </p>
</td></tr>
</table>

</div>
</div>
<a name="structnt__keydetector__afid" id="structnt__keydetector__afid"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct nt_keydetector_afid</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>The main structure representing the AFID key detector. An instance of this data type represents the AFID key detector. Consisting of parameters of filters, the AFID automatic sensitive calibration, and update rate.</p>
<p>You're responsible to initialize all the members before registering the AFID in the module. This structure can be allocated in ROM. </p>
</div><div class="dynheader">
Collaboration diagram for nt_keydetector_afid:</div>
<div class="dyncontent">
<div class="center"><img src="structnt__keydetector__afid__coll__graph.png" border="0" usemap="#nt__keydetector__afid_coll__map" alt="Collaboration graph"/></div>
<map name="nt__keydetector__afid_coll__map" id="nt__keydetector__afid_coll__map">
<area shape="rect" id="node2" href="group__filter.html#structnt__filter__iir" title="{nt_filter_iir\n|+ coef1\l|}" alt="" coords="5,20,87,97"/><area shape="rect" id="node3" href="group__filter.html#structnt__filter__fbutt" title="{nt_filter_fbutt\n|+ cutoff\l|}" alt="" coords="111,20,207,97"/><area shape="rect" id="node4" href="group__afid.html#structnt__keydetector__afid__asc" title="{nt_keydetector_afid_asc\n|+ touch_threshold_fall_rate\l+ noise_resets_minimum\l+ resets_for_touch\l|}" alt="" coords="231,5,410,112"/><area shape="rect" id="node5" href="group__filter.html#structnt__filter__moving__average" title="{nt_filter_moving_average\n|+ n2_order\l|}" alt="" coords="434,20,597,97"/></map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="affd60735e8e1a1bdbef041499b44f515"></a>struct <a class="el" href="group__afid.html#structnt__keydetector__afid__asc">nt_keydetector_afid_asc</a></td>
<td class="fieldname">
asc</td>
<td class="fielddoc">
<p>Automatic Sensitive Calibration structure for the AFID detector. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="afb1a698319c8d265a4160429654ca77a"></a>struct <a class="el" href="group__filter.html#structnt__filter__moving__average">nt_filter_moving_average</a></td>
<td class="fieldname">
base_avrg</td>
<td class="fielddoc">
<p>Settings of the moving average filter for the baseline in release state of electrode. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aa171801807571fceaecb808b689ace11"></a>struct <a class="el" href="group__filter.html#structnt__filter__fbutt">nt_filter_fbutt</a></td>
<td class="fieldname">
fast_signal_filter</td>
<td class="fielddoc">
<p>Signal butterworth signal (fast). </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a7c2bafdb515d6d97a57409a4ab22305f"></a>uint16_t</td>
<td class="fieldname">
reset_rate</td>
<td class="fielddoc">
<p>Reset rate of the AFID. Cannot be 0. It can clear integration value to avoid the long-term temperature drift </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ace19238cedaedcf4c2b16547c78d7ca4"></a>struct <a class="el" href="group__filter.html#structnt__filter__iir">nt_filter_iir</a></td>
<td class="fieldname">
signal_filter</td>
<td class="fielddoc">
<p>Coefficient of the input IIR signal filter, used to suppress high frequency noise. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a75f36ce7320cf3202969f83da61c61de"></a>struct <a class="el" href="group__filter.html#structnt__filter__fbutt">nt_filter_fbutt</a></td>
<td class="fieldname">
slow_signal_filter</td>
<td class="fielddoc">
<p>Baseline butterworth signal (slow). </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga9f4ab088e1b54439d63a36b3503055f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NT_KEYDETECTOR_AFID_ASC_DEFAULT</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>AFID Automatic Sensitive Calibration default ASC settings:</p>
<ul>
<li>touch_threshold_fall_rate (default 255)</li>
<li>noise_resets_minimum (default 128)</li>
<li>resets_for_touch (default 6) This default values for AFID ASC definition for example: <div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="group__afid.html#structnt__keydetector__afid">nt_keydetector_afid</a> keydec =</div>
<div class="line">{</div>
<div class="line">    .<a class="code" href="group__afid.html#ace19238cedaedcf4c2b16547c78d7ca4">signal_filter</a> = {</div>
<div class="line">        .cutoff = 8</div>
<div class="line">    },</div>
<div class="line">    .baseline_filter = {</div>
<div class="line">        .cutoff = 4</div>
<div class="line">    },</div>
<div class="line">    .reset_rate = 1000,</div>
<div class="line">    .asc = <a class="code" href="group__afid.html#ga9f4ab088e1b54439d63a36b3503055f3">NT_KEYDETECTOR_AFID_ASC_DEFAULT</a>,</div>
<div class="line">};</div>
</div><!-- fragment --> </li>
</ul>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="gab0fa0f9c83af71347537b8e35fa9867e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structnt__keydetector__interface.html">nt_keydetector_interface</a> nt_keydetector_afid_interface</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>AFID key detector interface structure. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Aug 2 2024 08:33:27 for NXP Touch Library Reference Manual by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
