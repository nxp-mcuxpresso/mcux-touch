<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>NXP Touch Library Reference Manual: mbw Detector</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nxp_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">NXP Touch Library Reference Manual
   &#160;<span id="projectnumber">Rev 2.0</span>
   </div>
   <div id="projectbrief">NXP Semiconductors, Inc.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__mbw__prv.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a>  </div>
  <div class="headertitle">
<div class="title">mbw Detector<div class="ingroups"><a class="el" href="group__detectors__private.html">Key Detectors</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<p>The mbw key detector is a method for recognition of the touch or release states. It can be used for each type of control.</p>
<p>If the measured sample is reported as a valid sample, the module calculates the delta value from the actual signal value and the baseline value. The delta value is compared to the threshold value computed from the expected signal and baseline values. Based on the result, it determines the electrode state, which can be released, touched, changing from released to touched, and changing from touched to released. The method uses moving average filters to determine the baseline and expected signal values with a different depth of the filter, depending on the state of the electrode. The deadband filters in the horizontal and vertical directions are also implemented. </p>
<div class="dynheader">
Collaboration diagram for mbw Detector:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__mbw__prv.png" border="0" alt="" usemap="#group____mbw____prv"/>
<map name="group____mbw____prv" id="group____mbw____prv">
<area shape="rect" id="node2" href="group__detectors__private.html" title="Key Detectors" alt="" coords="5,5,111,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structnt__keydetector__mbw__data"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbw__prv.html#structnt__keydetector__mbw__data">nt_keydetector_mbw_data</a></td></tr>
<tr class="separator:structnt__keydetector__mbw__data"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structnt__keydetector__mbw__data" id="structnt__keydetector__mbw__data"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct nt_keydetector_mbw_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>mbw RAM structure. This structure is used for internal algorithms to store data, while evaluating mbw. Contains the data of the resulting calculation and auxiliary variables.</p>
<p>This structure manages and uses internal methods only. </p>
</div><div class="dynheader">
Collaboration diagram for nt_keydetector_mbw_data:</div>
<div class="dyncontent">
<div class="center"><img src="structnt__keydetector__mbw__data__coll__graph.png" border="0" usemap="#nt__keydetector__mbw__data_coll__map" alt="Collaboration graph"/></div>
<map name="nt__keydetector__mbw__data_coll__map" id="nt__keydetector__mbw__data_coll__map">
<area shape="rect" id="node2" href="group__filter.html#structnt__filter__asym__smooth" title="{nt_filter_asym_smooth\n|+ alpha_up\l+ alpha_up1\l+ alpha_down\l+ alpha_down1\l|}" alt="" coords="5,5,159,127"/><area shape="rect" id="node3" href="group__filter__private.html#structnt__filter__moving__average__data" title="{nt_filter_moving_average_data\n|+ sum\l|}" alt="" coords="183,27,378,105"/><area shape="rect" id="node4" href="group__filter.html#structnt__filter__smooth" title="{nt_filter_smooth\n|+ alpha\l+ alpha1\l|}" alt="" coords="402,20,517,112"/><area shape="rect" id="node5" href="group__filter.html#structnt__filter__moving__average" title="{nt_filter_moving_average\n|+ n2_order\l|}" alt="" coords="545,27,707,105"/></map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a355da295bf1dc7d308b39e0ba328873b"></a>struct <br class="typebreak"/>
<a class="el" href="group__filter__private.html#structnt__filter__moving__average__data">nt_filter_moving_average_data</a></td>
<td class="fieldname">
base_avrg</td>
<td class="fielddoc">
<p>Baseline moving average filter data. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a793eee6b6b23eae4ca93f575f899b927"></a>struct <a class="el" href="group__filter.html#structnt__filter__moving__average">nt_filter_moving_average</a></td>
<td class="fieldname">
base_avrg_init</td>
<td class="fielddoc">
<p>Baseline moving average filter settings. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a232a35f1f90549a69bead249a0292775"></a>struct <a class="el" href="group__filter.html#structnt__filter__asym__smooth">nt_filter_asym_smooth</a></td>
<td class="fieldname">
base_smooth</td>
<td class="fielddoc">
<p>Baseline Asym Smooth filter </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="af3c1a5af1d1afe21014e81f4f4d1d735"></a>struct <a class="el" href="group__filter.html#structnt__filter__smooth">nt_filter_smooth</a></td>
<td class="fieldname">
base_smooth_fix</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac6688609d2e58b49630c7c25a17ff7da"></a>struct <a class="el" href="group__filter.html#structnt__filter__smooth">nt_filter_smooth</a></td>
<td class="fieldname">
base_smooth_release</td>
<td class="fielddoc">
<p>Baseline Smooth filter After Release (faster) </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a55e9af8e65351e2cd56d861e8dc6beff"></a>uint16_t</td>
<td class="fieldname">
baseline_add_no_touch</td>
<td class="fielddoc">
<p>Add to counter when no touch or number of touches &gt; touch_limit, higher number will slowdown the baseline (by factor baseline_add_no_touch / baseline_add_touch) if no touch event </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a3a863507cc6e005deb370dbfac8ae262"></a>uint16_t</td>
<td class="fieldname">
baseline_add_touch</td>
<td class="fielddoc">
<p>Add to counter when touch, when touched, baseline tracker slows down by factor, (baseline_add_no_touch / baseline_add_touch) </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a26afc2f143f7e8183cf6abe8e9c2cf6a"></a>uint16_t</td>
<td class="fieldname">
baseline_cnt</td>
<td class="fielddoc">
<p>Counter for baseline tracking measure the baseline window </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a70f9e59e3b5a47030aff79b8865f7ef6"></a>uint16_t</td>
<td class="fieldname">
baseline_cnt_max</td>
<td class="fielddoc">
<p>Maximum value of the baseline tracking counter calculated by baseline_track_window * system_time_period </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="abf76aacc72661246abb3dbbd3f3a58e5"></a>int32_t</td>
<td class="fieldname">
deadband_cnt</td>
<td class="fielddoc">
<p>Deadband event counter. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a108a0028ee3335148b71c6dab2dcf507"></a>uint32_t</td>
<td class="fieldname">
deadband_h</td>
<td class="fielddoc">
<p>Deadband high watermark </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a4af72a9cf8e1cbbc6f1aab8a69dd5e00"></a>uint8_t</td>
<td class="fieldname">
debounce_cnt</td>
<td class="fielddoc">
<p>Counter of measured deltas bounced higher then delta limitation </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aaa028733be97df563d1cdf2bfeb9f31f"></a>int32_t</td>
<td class="fieldname">
entry_event_cnt</td>
<td class="fielddoc">
<p>Event counter value. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a5cda0167eaec1e6e977e54e9892e3986"></a>uint32_t</td>
<td class="fieldname">
f_noise</td>
<td class="fielddoc">
<p>Fast Noise value. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a1cf34c239ee541c7fa44b0df52d75c67"></a>struct <br class="typebreak"/>
<a class="el" href="group__filter__private.html#structnt__filter__moving__average__data">nt_filter_moving_average_data</a></td>
<td class="fieldname">
f_noise_avrg</td>
<td class="fielddoc">
<p>Fast Noise signal moving average filter data. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a933dca9164f5b0c86900a236567baac7"></a>struct <a class="el" href="group__filter.html#structnt__filter__moving__average">nt_filter_moving_average</a></td>
<td class="fieldname">
f_noise_avrg_init</td>
<td class="fielddoc">
<p>Fast Noise moving average filter settings. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a198928222a2a461735783ef43c331bb3"></a>enum <a class="el" href="group__filter__private.html#ga0f0268290e12b9076137176a513ae59a">nt_filter_state</a></td>
<td class="fieldname">
filter_state</td>
<td class="fielddoc">
<p>Input filter state. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a12b8607a129deac2d18f89d489b3922e"></a>uint32_t</td>
<td class="fieldname">
noise</td>
<td class="fielddoc">
<p>Noise value. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a0470e9c903745a88fdf5eb4d94e3ad34"></a>struct <br class="typebreak"/>
<a class="el" href="group__filter__private.html#structnt__filter__moving__average__data">nt_filter_moving_average_data</a></td>
<td class="fieldname">
noise_avrg</td>
<td class="fielddoc">
<p>Noise signal moving average filter data. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a5f87b7f57e01934934d7041e9802dad0"></a>struct <a class="el" href="group__filter.html#structnt__filter__moving__average">nt_filter_moving_average</a></td>
<td class="fieldname">
noise_avrg_init</td>
<td class="fielddoc">
<p>Noise moving average filter settings. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a9a0f83a2be32593bd6de794f9ce138e3"></a>uint32_t</td>
<td class="fieldname">
predicted_signal</td>
<td class="fielddoc">
<p>Predicted signal value. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a1e79a0582585b4d1a96c6855277b2da1"></a>struct <br class="typebreak"/>
<a class="el" href="group__filter__private.html#structnt__filter__moving__average__data">nt_filter_moving_average_data</a></td>
<td class="fieldname">
predicted_signal_avrg</td>
<td class="fielddoc">
<p>Predicted signal line moving average filter data. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a15d2b948ac4e0ca384355097bf6af3de"></a>struct <a class="el" href="group__filter.html#structnt__filter__moving__average">nt_filter_moving_average</a></td>
<td class="fieldname">
predicted_signal_avrg_init</td>
<td class="fielddoc">
<p>Predicted signal moving average filter settings. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a8084d3b52dfebf8446b5a8cb1621c88c"></a>int16_t</td>
<td class="fieldname">
prev_delta</td>
<td class="fielddoc">
<p>Previous signed delta used for debouncing </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aa622ebb3a7a4abd53f0bd7ff77775e21"></a>int32_t</td>
<td class="fieldname">
recovery_cnt</td>
<td class="fielddoc">
<p>Recovery counter. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ae623e7228815553781694bfbb8202403"></a>uint8_t</td>
<td class="fieldname">
shist</td>
<td class="fielddoc">
<p>signal history counter </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aa3f1706e01cd71fd78c0549c5f168809"></a>uint16_t *</td>
<td class="fieldname">
signal_buffer</td>
<td class="fielddoc">
<p>Shift register for raw signals (for min filtering) </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a38b655b3129fc30bf74d83bcac6bbee1"></a>uint16_t</td>
<td class="fieldname">
smooth_baseline</td>
<td class="fielddoc">
<p>Raw signal filtered by the baseline Smooth filter used for baseline </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a91e2a29d4f79291644c72878ce90a52a"></a>uint32_t</td>
<td class="fieldname">
smooth_baseline_accu</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ae2feebea4a2bf41c58d1deb581e3daeb"></a>uint16_t</td>
<td class="fieldname">
smooth_baseline_accu_count</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab0ede378e58c971b6400515ffba9a72b"></a>uint16_t</td>
<td class="fieldname">
smooth_baseline_min</td>
<td class="fielddoc">
<p>Minimum value from actual baseline window used for next baseline window </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac208d91de4144ac74b9d0449eabcc016"></a>uint16_t</td>
<td class="fieldname">
smooth_signal</td>
<td class="fielddoc">
<p>Signal filtered by the signal Smooth filter used as actual signal </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a6935a7380590b9b55bcf03c2566243f1"></a>uint16_t</td>
<td class="fieldname">
smooth_signal_max</td>
<td class="fielddoc">
<p>Maximum value of smoothed signal in baseline window </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a2364671961454faafeee1e3fa90f069e"></a>uint16_t</td>
<td class="fieldname">
smooth_signal_min</td>
<td class="fielddoc">
<p>Minimum value of smoothed signal in baseline window </p>
</td></tr>
</table>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Aug 2 2024 08:33:28 for NXP Touch Library Reference Manual by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
