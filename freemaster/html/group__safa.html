<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>NXP Touch Library Reference Manual: Safa Detector</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nxp_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">NXP Touch Library Reference Manual
   &#160;<span id="projectnumber">Rev 2.0</span>
   </div>
   <div id="projectbrief">NXP Semiconductors, Inc.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__safa.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Safa Detector<div class="ingroups"><a class="el" href="group__detectors.html">Key Detectors</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<p>The Safa key detector is a method for recognizing the touch or release states. It can be used for each type of control.</p>
<p>If the measured sample is reported as a valid sample, the module calculates the delta value from the actual signal and baseline values. The delta value is compared to the threshold value computed from the expected signal and baseline values. Based on the result, it determines the electrode state, which can be released, touched, changing from released to touch, and changing from touched to release. This method is using moving average filters to determine the baseline and the expected signal values, with different depth of the filter, depending on the state of the electrode. The deadband filters in the horizontal and vertical directions are also implemented. </p>
<div class="dynheader">
Collaboration diagram for Safa Detector:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__safa.png" border="0" alt="" usemap="#group____safa"/>
<map name="group____safa" id="group____safa">
<area shape="rect" id="node2" href="group__detectors.html" title="Key Detectors" alt="" coords="5,5,111,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structnt__keydetector__safa"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__safa.html#structnt__keydetector__safa">nt_keydetector_safa</a></td></tr>
<tr class="separator:structnt__keydetector__safa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gab561965c59e5f6e4d64a4189088038d9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="group__safa.html#structnt__keydetector__safa">nt_keydetector_safa</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__safa.html#gab561965c59e5f6e4d64a4189088038d9">nt_keydetector_safa_default</a></td></tr>
<tr class="separator:gab561965c59e5f6e4d64a4189088038d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc463ce062fd9f41efa3c5803f7bae25"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structnt__keydetector__interface.html">nt_keydetector_interface</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__safa.html#gafc463ce062fd9f41efa3c5803f7bae25">nt_keydetector_safa_interface</a></td></tr>
<tr class="separator:gafc463ce062fd9f41efa3c5803f7bae25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structnt__keydetector__safa" id="structnt__keydetector__safa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct nt_keydetector_safa</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>The main structure representing the Safa key detector. An instance of this data type represents the Safa key detector. It consists of used filters' parameters.</p>
<p>You're responsible for initializing all the members before registering the Safa in the module. This structure can be allocated in ROM. </p>
</div><div class="dynheader">
Collaboration diagram for nt_keydetector_safa:</div>
<div class="dyncontent">
<div class="center"><img src="structnt__keydetector__safa__coll__graph.png" border="0" usemap="#nt__keydetector__safa_coll__map" alt="Collaboration graph"/></div>
<map name="nt__keydetector__safa_coll__map" id="nt__keydetector__safa_coll__map">
<area shape="rect" id="node2" href="group__filter.html#structnt__filter__iir" title="{nt_filter_iir\n|+ coef1\l|}" alt="" coords="5,5,87,83"/><area shape="rect" id="node3" href="group__filter.html#structnt__filter__moving__average" title="{nt_filter_moving_average\n|+ n2_order\l|}" alt="" coords="111,5,274,83"/></map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a32e3382f27a6909d11e091ee89eae937"></a>struct <a class="el" href="group__filter.html#structnt__filter__moving__average">nt_filter_moving_average</a></td>
<td class="fieldname">
base_avrg</td>
<td class="fielddoc">
<p>Settings of the moving average filter for the baseline in the release state of an electrode. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a659893bd505fe200bec15571beea1329"></a>uint32_t</td>
<td class="fieldname">
deadband_cnt</td>
<td class="fielddoc">
<p>Sample count for the deadband filter. This field specifies the number of samples that cannot proceed to the next event. For Example: after the touch event, a release event with "deadband_cnt" samples can follow. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a82dcf471b5119274ad0b564c5541abb1"></a>uint32_t</td>
<td class="fieldname">
entry_event_cnt</td>
<td class="fielddoc">
<p>Sample count for the touch event. This means that this count of samples must meet the touch condition to trigger a real touch event. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aac39f9835e1bccc0d80e1575d8dd6d93"></a>uint32_t</td>
<td class="fieldname">
min_noise_limit</td>
<td class="fielddoc">
<p>Minimum noise value. Used for predicted signal calculation and delta signal filter limits </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a23a6d652e2e356067075f8c21cc904bf"></a>struct <a class="el" href="group__filter.html#structnt__filter__moving__average">nt_filter_moving_average</a></td>
<td class="fieldname">
non_activity_avrg</td>
<td class="fielddoc">
<p>Settings of the moving average filter for the signals in the inactivity state of an electrode. (for example baseline in a touch state). </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aed05aef2dc9e00dc5f3409aa14f24bc5"></a>struct <a class="el" href="group__filter.html#structnt__filter__iir">nt_filter_iir</a></td>
<td class="fieldname">
signal_filter</td>
<td class="fielddoc">
<p>Coefficient of the input IIR signal filter, used to suppress high-frequency noise. </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a3ab0abafecf1fdca43ade7420402fae6"></a>uint32_t</td>
<td class="fieldname">
signal_to_noise_ratio</td>
<td class="fielddoc">
<p>Signal-to-noise ratio – it is used for counting the minimum size of the signal that is ignored. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="gab561965c59e5f6e4d64a4189088038d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="group__safa.html#structnt__keydetector__safa">nt_keydetector_safa</a> nt_keydetector_safa_default</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The default Safa settings of the key detector are:</p>
<ul>
<li>signal_filter (2 by default)</li>
<li>base_avrg (9 by default, which means 512 samples)</li>
<li>non_activity_avrg (NT_FILTER_MOVING_AVERAGE_MAX_ORDER by default, which means 65K samples)</li>
<li>entry_event_cnt (8 by default)</li>
<li>signal_to_noise_ratio (16 by default)</li>
<li>deadband_cnt (10 by default)</li>
<li>min_noise_limit (20 by default) Here is an example definition of the default values for SAFA ASC: <div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="group__safa.html#structnt__keydetector__safa">nt_keydetector_safa</a> <a class="code" href="group__safa.html#gab561965c59e5f6e4d64a4189088038d9">nt_keydetector_safa_default</a> =</div>
<div class="line">{</div>
<div class="line">    .<a class="code" href="group__safa.html#aed05aef2dc9e00dc5f3409aa14f24bc5">signal_filter</a> = 2,</div>
<div class="line">    .base_avrg = {.n2_order = 9},</div>
<div class="line">    .non_activity_avrg =  {.n2_order = <a class="code" href="group__filter.html#ga62d43fb098bc60270ce1397c063d140e">NT_FILTER_MOVING_AVERAGE_MAX_ORDER</a>},</div>
<div class="line">    .entry_event_cnt = 8,</div>
<div class="line">    .signal_to_noise_ratio = 16,</div>
<div class="line">    .deadband_cnt = 10,</div>
<div class="line">    .min_noise_limit = 20,</div>
<div class="line">};</div>
</div><!-- fragment --> </li>
</ul>

</div>
</div>
<a class="anchor" id="gafc463ce062fd9f41efa3c5803f7bae25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structnt__keydetector__interface.html">nt_keydetector_interface</a> nt_keydetector_safa_interface</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SAFA key detector interface structure. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Aug 2 2024 08:33:27 for NXP Touch Library Reference Manual by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
